<html>
  <head>
    <title>Pizero Temperature real-time plots</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(draw1Visualization);

//######
      function draw1Visualization() {
		// Some raw data (not necessarily accurate)
	var data = google.visualization.arrayToDataTable([
		['Time', 'Temp'],
		['2021-02-06T10:10:09',20.75],
['2021-02-06T10:15:01',20.75],
['2021-02-06T10:27:08',20.9375],
['2021-02-06T10:30:01',21],
['2021-02-06T10:35:01',20.9375],
['2021-02-06T10:40:01',21],
['2021-02-06T10:45:01',21],
['2021-02-06T10:50:01',20.9375],
['2021-02-06T10:55:02',20.9375],
['2021-02-06T11:00:02',20.9375],
['2021-02-06T11:05:01',20.875],
['2021-02-06T11:10:01',20.8125],
['2021-02-06T11:15:01',20.8125],
['2021-02-06T11:20:01',20.875],
['2021-02-06T11:25:01',20.8125],
['2021-02-06T11:30:02',20.875],
['2021-02-06T11:35:01',20.875],
['2021-02-06T11:40:02',20.9375],
['2021-02-06T11:45:02',20.875],
['2021-02-06T11:50:01',20.9375],
['2021-02-06T11:55:01',20.875],
['2021-02-06T12:00:01',21],
['2021-02-06T12:05:01',21.0625],
['2021-02-06T12:10:01',21.1875],
['2021-02-06T12:15:01',21.25],
['2021-02-06T12:20:02',21.0625],
['2021-02-06T12:25:01',21.1875],
['2021-02-06T12:30:01',21.25],
['2021-02-06T12:35:02',21.25],
['2021-02-06T12:40:02',21.3125],
['2021-02-06T12:45:01',21.5],
['2021-02-06T12:50:02',21.875],
['2021-02-06T12:55:02',22],
['2021-02-06T13:00:02',22.125],
['2021-02-06T13:05:08',22.375],
['2021-02-06T13:10:01',22.25],
['2021-02-06T13:15:01',22.25],
['2021-02-06T13:20:01',22.3125],
['2021-02-06T13:25:01',22.375],
['2021-02-06T13:30:01',22.4375],
['2021-02-06T13:35:01',22.6875],
['2021-02-06T13:40:01',22.8125],
['2021-02-06T13:45:01',22.875],
['2021-02-06T13:50:01',22.8125],
['2021-02-06T13:55:02',22.8125],
['2021-02-06T14:00:01',22.9375],
['2021-02-06T14:05:01',22.6875],
['2021-02-06T14:10:01',22.6875],
['2021-02-06T14:15:01',22.6875],
['2021-02-06T14:20:01',22.875],
['2021-02-06T14:25:01',22.9375],
['2021-02-06T14:30:02',22.8125],
['2021-02-06T14:35:01',22.8125],
['2021-02-06T14:40:01',22.75],
['2021-02-06T14:45:01',22.875],
['2021-02-06T14:50:02',22.75],
['2021-02-06T14:55:02',22.75],
['2021-02-06T15:00:01',22.6875],
['2021-02-06T15:05:01',22.6875],
['2021-02-06T15:10:01',22.6875],
['2021-02-06T15:15:01',22.75],
['2021-02-06T15:20:01',22.6875],
['2021-02-06T15:25:01',22.75],
['2021-02-06T15:30:01',22.6875],
['2021-02-06T15:35:01',22.3125],
['2021-02-06T15:40:01',22.5],
['2021-02-06T15:45:01',22.4375],
['2021-02-06T15:50:01',22.125],
['2021-02-06T15:55:01',22.5625],
['2021-02-06T16:00:01',22.625],
['2021-02-06T16:05:01',22.8125],
['2021-02-06T16:10:02',22.6875],
['2021-02-06T16:15:01',22.5625],
['2021-02-06T16:20:01',22.4375],
['2021-02-06T16:25:01',22.3125],
['2021-02-06T16:30:01',22.1875],
['2021-02-06T16:35:01',22.0625],
['2021-02-06T16:40:02',21.9375],
['2021-02-06T16:45:01',21.875],
['2021-02-06T16:50:02',21.875],
['2021-02-06T16:55:02',21.9375],
['2021-02-06T17:00:01',22.0625],
['2021-02-06T17:05:01',21.9375],
['2021-02-06T17:10:19',21.9375],
['2021-02-06T17:15:01',21.625],
['2021-02-06T17:20:01',21.625],
['2021-02-06T17:25:01',21.4375],
['2021-02-06T17:30:01',21.3125],
['2021-02-06T17:35:01',21.25],
['2021-02-06T17:40:01',21.125],
['2021-02-06T17:45:01',21.25],
['2021-02-06T17:50:01',21.375],
['2021-02-06T17:55:01',21.6875],
['2021-02-06T18:00:02',21.6875],
['2021-02-06T18:05:01',21.625],
['2021-02-06T18:10:01',21.6875],
['2021-02-06T18:15:01',21.375],
['2021-02-06T18:20:02',21.3125],
['2021-02-06T18:25:02',21.1875],
['2021-02-06T18:30:01',21.125],
['2021-02-06T18:35:01',21.125],
['2021-02-06T18:40:02',21.0625],
['2021-02-06T18:45:02',20.9375],
['2021-02-06T18:50:01',20.8125],
['2021-02-06T18:55:01',20.75],
['2021-02-06T19:00:01',20.625],
['2021-02-06T19:05:01',20.5625],
['2021-02-06T19:10:02',20.5625],
['2021-02-06T19:15:02',20.5],
['2021-02-06T19:20:01',20.4375],
['2021-02-06T19:25:01',20.3125],
['2021-02-06T19:30:01',20.3125],
['2021-02-06T19:35:01',20.3125],
['2021-02-06T19:40:01',20.25],
['2021-02-06T19:45:02',20.375],
['2021-02-06T19:50:01',20.3125],
['2021-02-06T19:55:01',20.3125],
['2021-02-06T20:00:01',20.4375],
['2021-02-06T20:05:01',20.5],
['2021-02-06T20:10:01',20.5],
['2021-02-06T20:15:01',20.5625],
['2021-02-06T20:20:01',20.8125],
['2021-02-06T20:25:01',20.875],
['2021-02-06T20:30:01',21],
['2021-02-06T20:35:01',20.5],
['2021-02-06T20:40:01',20.5],
['2021-02-06T20:45:02',20.4375],
['2021-02-06T20:50:01',20.375],
['2021-02-06T20:55:01',20.25],
['2021-02-06T21:00:02',20.1875],
['2021-02-06T21:05:02',20.125],
['2021-02-06T21:10:01',20.0625],
['2021-02-06T21:15:01',20],
['2021-02-06T21:20:01',20],
['2021-02-06T21:25:01',20],
['2021-02-06T21:30:01',19.875],
['2021-02-06T21:35:01',19.875],
['2021-02-06T21:40:01',19.75],
		]);
        var options = {
          title : 'PiZero Temp Log 2021-02-06T21:40:01',
          vAxis: {title: 'Degrees',minValue:7,viewWindow:{ min: 7 }},
          hAxis: {title: 'Timestamp'},
          seriesType: 'bars',
          series: {1: {type: 'line'}}
        };

        var chart = new google.visualization.ComboChart(document.getElementById('chart_div1'));
        chart.draw(data, options);
	}
//######
    </script>
    <script type="text/javascript" src="vendor/smoothie.js"></script>
    <script type="text/javascript" src="vendor/reconnecting-websocket.min.js"></script>
    <script type="text/javascript">

      var readings = new TimeSeries();

      function createTimeline() {
        var chart = new SmoothieChart({
          millisPerPixel: 1000,
          interpolation:'bezier',
       grid:{millisPerLine:60000,verticalSections:15,fillStyle:'#ffffff'},
       tooltip:true,
       timestampFormatter:SmoothieChart.timeFormatter,
          minValue:0.0,
          maxValue:30.0
        });

        chart.addTimeSeries(readings, { 
            strokeStyle: '#006eff',
            fillStyle: 'rgba(122,122,122,0.30)',
            lineWidth: 3 });

        chart.streamTo(document.getElementById("chart"), 500);
      }

      var ws = new ReconnectingWebSocket('ws://192.168.1.26:8080/');
      ws.onopen = function() {
        document.body.style.backgroundColor = '#fff';
      };
      ws.onclose = function() {
        document.body.style.backgroundColor = null;
      };
      ws.onmessage = function(event) {
        var data = event.data.split(",");
        var timestamp = parseFloat(data[0]) * 1000;  // expects ms
        var value = parseFloat(data[1]);
        readings.append(timestamp, value);
        document.getElementById("temperature").innerHTML = value;
      };

    var myVar = setInterval(myTimer, 1000);

    function myTimer() {
     var d = new Date();
     var t = 'PiZero Temperature Sensor '+d.toLocaleTimeString();
     document.getElementById("demo2").innerHTML = t;
    }

    </script>
  </head>
  <body onload="createTimeline()">
    <h2 id="demo2"></h2>
    <h2 id="temperature"></h2>
    <canvas id="chart" width=800 height="400"></canvas>
    <div id="chart_div1" style="width: 800px; height: 400px;"></div>

  </body>
</html>
